// Модальное окно политики конфиденциальности
document.addEventListener('DOMContentLoaded', function() {
    // Создаем модальное окно, если его еще нет
    if (!document.getElementById('privacy-modal')) {
        createPrivacyModal();
    }
    
    // Добавляем обработчики событий для ссылок на политику конфиденциальности
    const privacyLinks = document.querySelectorAll('.privacy-link');
    privacyLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            openPrivacyModal();
        });
    });
});

function createPrivacyModal() {
    const modal = document.createElement('div');
    modal.id = 'privacy-modal';
    modal.className = 'modal';
    modal.innerHTML = `
        <div class="modal-content">
            <div class="modal-header">
                <h2>Политика конфиденциальности</h2>
                <span class="close" onclick="closePrivacyModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="privacy-content">
                    <h3>1. Общие положения</h3>
                    <p>Настоящая Политика конфиденциальности (далее — «Политика») действует в отношении информации, которую ООО «Диамант» (далее — «Компания») может получить о пользователе во время использования им сайта diamant.ru.</p>
                    
                    <h3>2. Персональные данные пользователей</h3>
                    <p>Персональные данные пользователей обрабатываются в соответствии с ФЗ «О персональных данных» № 152-ФЗ. Компания обрабатывает следующие персональные данные:</p>
                    <ul>
                        <li>Фамилия, имя, отчество</li>
                        <li>Электронная почта</li>
                        <li>Номер телефона</li>
                        <li>Дата рождения</li>
                        <li>Город проживания</li>
                        <li>Пол</li>
                        <li>Информация о предпочтениях пользователя</li>
                    </ul>
                    
                    <h3>3. Цели обработки персональных данных</h3>
                    <p>Персональные данные пользователей обрабатываются в целях:</p>
                    <ul>
                        <li>Регистрации пользователя на сайте</li>
                        <li>Предоставления пользователю возможности пользования сервисами сайта</li>
                        <li>Связи с пользователем для предоставления клиентской поддержки</li>
                        <li>Улучшения качества сайта и сервисов</li>
                        <li>Проведения статистических исследований</li>
                        <li>Информирования пользователя о новых товарах и услугах</li>
                    </ul>
                    
                    <h3>4. Способы и сроки обработки персональной информации</h3>
                    <p>Обработка персональных данных пользователя осуществляется без ограничения срока, любым законным способом, в том числе в информационных системах персональных данных с использованием средств автоматизации или без использования таких средств.</p>
                    
                    <h3>5. Передача персональных данных третьим лицам</h3>
                    <p>Компания не передает персональные данные третьим лицам, за исключением случаев:</p>
                    <ul>
                        <li>Пользователь выразил свое согласие на такие действия</li>
                        <li>Передача предусмотрена российским законодательством</li>
                        <li>Передача происходит в рамках продажи или иной передачи бизнеса</li>
                    </ul>
                    
                    <h3>6. Защита персональной информации</h3>
                    <p>Компания принимает необходимые организационные и технические меры для защиты персональной информации пользователя от неправомерного или случайного доступа, уничтожения, изменения, блокирования, копирования, распространения, а также от иных неправомерных действий третьих лиц.</p>
                    
                    <h3>7. Изменение политики конфиденциальности</h3>
                    <p>Компания имеет право вносить изменения в настоящую Политику конфиденциальности. При внесении изменений в актуальной редакции указывается дата последнего обновления.</p>
                    
                    <h3>8. Контактная информация</h3>
                    <p>По всем вопросам, касающимся обработки персональных данных, пользователь может обращаться по адресу: email@diamant.ru или по телефону: 8 800 600 01 10.</p>
                    
                    <p><strong>Дата последнего обновления: 24.05.2025</strong></p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" onclick="closePrivacyModal()">Закрыть</button>
                <button class="btn btn-primary" onclick="downloadPrivacyPolicy()">Скачать PDF</button>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    
    // Закрытие модального окна при клике вне его
    modal.addEventListener('click', function(e) {
        if (e.target === modal) {
            closePrivacyModal();
        }
    });
}

function openPrivacyModal() {
    const modal = document.getElementById('privacy-modal');
    if (modal) {
        modal.style.display = 'block';
        document.body.style.overflow = 'hidden'; // Предотвращаем прокрутку фона
    }
}

function closePrivacyModal() {
    const modal = document.getElementById('privacy-modal');
    if (modal) {
        modal.style.display = 'none';
        document.body.style.overflow = ''; // Восстанавливаем прокрутку
    }
}

function downloadPrivacyPolicy() {
    // Создаем содержимое для загрузки
    const content = `
ПОЛИТИКА КОНФИДЕНЦИАЛЬНОСТИ
ООО "Диамант"

1. ОБЩИЕ ПОЛОЖЕНИЯ
Настоящая Политика конфиденциальности действует в отношении информации, которую ООО «Диамант» может получить о пользователе во время использования им сайта diamant.ru.

2. ПЕРСОНАЛЬНЫЕ ДАННЫЕ ПОЛЬЗОВАТЕЛЕЙ
Персональные данные пользователей обрабатываются в соответствии с ФЗ «О персональных данных» № 152-ФЗ. Компания обрабатывает следующие персональные данные:
- Фамилия, имя, отчество
- Электронная почта
- Номер телефона
- Дата рождения
- Город проживания
- Пол
- Информация о предпочтениях пользователя

3. ЦЕЛИ ОБРАБОТКИ ПЕРСОНАЛЬНЫХ ДАННЫХ
Персональные данные пользователей обрабатываются в целях:
- Регистрации пользователя на сайте
- Предоставления пользователю возможности пользования сервисами сайта
- Связи с пользователем для предоставления клиентской поддержки
- Улучшения качества сайта и сервисов
- Проведения статистических исследований
- Информирования пользователя о новых товарах и услугах

4. СПОСОБЫ И СРОКИ ОБРАБОТКИ ПЕРСОНАЛЬНОЙ ИНФОРМАЦИИ
Обработка персональных данных пользователя осуществляется без ограничения срока, любым законным способом, в том числе в информационных системах персональных данных с использованием средств автоматизации или без использования таких средств.

5. ПЕРЕДАЧА ПЕРСОНАЛЬНЫХ ДАННЫХ ТРЕТЬИМ ЛИЦАМ
Компания не передает персональные данные третьим лицам, за исключением случаев:
- Пользователь выразил свое согласие на такие действия
- Передача предусмотрена российским законодательством
- Передача происходит в рамках продажи или иной передачи бизнеса

6. ЗАЩИТА ПЕРСОНАЛЬНОЙ ИНФОРМАЦИИ
Компания принимает необходимые организационные и технические меры для защиты персональной информации пользователя от неправомерного или случайного доступа, уничтожения, изменения, блокирования, копирования, распространения, а также от иных неправомерных действий третьих лиц.

7. ИЗМЕНЕНИЕ ПОЛИТИКИ КОНФИДЕНЦИАЛЬНОСТИ
Компания имеет право вносить изменения в настоящую Политику конфиденциальности. При внесении изменений в актуальной редакции указывается дата последнего обновления.

8. КОНТАКТНАЯ ИНФОРМАЦИЯ
По всем вопросам, касающимся обработки персональных данных, пользователь может обращаться по адресу: email@diamant.ru или по телефону: 8 800 600 01 10.

Дата последнего обновления: 24.05.2025
    `;
    
    // Создаем blob и ссылку для скачивания
    const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'privacy_policy_diamant.txt';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    window.URL.revokeObjectURL(url);
}